---
title: "Contact lens report"
author: "Barry Mukundakrishnan, CID-01901006"
output: 
  pdf_document:
    df_print: kable
    number_sections: true
    highlight: tango
    latex_engine: xelatex
    keep_tex: true
fontsize: 11pt
geometry: margin=0.5in
---
\newpage
\tableofcontents
\newpage

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(comment = '')
#knitr::opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
```

# Pandas Import

```{python}
import pandas as pd
```

## Read File

```{python }
def read_file(filename, filter_columns):
    """
    Read Excel sheet and filter uneeded columns as shown
    """
    df_raw = pd.read_excel(filename, sheet_name='Scrubbed_data', index_col='REVIEW_DATE')
    df = df_raw.drop(columns = filter_columns, axis=1)
    return df
```

```{python }
filename = "data/Master-data_Q42021.xlsx"
# We don't need these columns
not_needed = ['OVERALL_RATING', 'COMFORT_RATING', 'VISION_RATING', 'VALUE_FOR_MONEY', 'PROS', 'CONS', 
              'ORIGINAL_SOURCE', 'REPLY_FROM_ACCUVUE','PRODUCT_LINK', 'WEBSITE']

text_data = read_file(filename, not_needed)
```

```{python }
text_data
```

